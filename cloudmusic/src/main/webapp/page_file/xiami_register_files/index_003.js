!function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="/",t(0)}([function(e,t,a){e.exports=a(10)},,,,,,,,,,function(e,t,a){a(11);var n=a(12);n.init()},function(e,t){},function(e,t){var a={init:function(){var e=this;e.referrer=document.referrer,e.validate="",e._attatchEvent()},_checkRequired:function(e,t){return!$(e).is(":visible")||($(e).val().length>0?($(e).parent().find("span").html(""),$(e).removeClass("error"),!0):($(e).parent().find("span").html(t),$(e).addClass("error").focus(),!1))},_checkMobile:function(e,t){if(!$(e).is(":visible"))return!0;if("+86"==$(e).parent().find("select").val()){if(!/^1[3|4|5|7|8]\d{9}$/.test($(e).val()))return $(e).parent().find("span").html(t),$(e).addClass("error").focus(),!1;$(e).parent().find("span").html(""),$(e).removeClass("error")}return!0},_checkAgreement:function(e,t){return!$(e).is(":visible")||(!!$(e).is(":checked")||(alert(t),!1))},_checkPassword:function(e,t){return!$(e).is(":visible")||(/^\w{6,12}$/.test($(e).val())?($(e).parent().find("span").html(""),$(e).removeClass("error"),!0):($(e).parent().find("span").html(t),$(e).addClass("error").focus(),!1))},_checkPasswordRepeat:function(e,t,a){return!$(e).is(":visible")&&!$(t).is(":visible")||($(t).val()!=$(e).val()?($(t).parent().find("span").html(a),$(t).addClass("error").focus(),!1):($(t).parent().find("span").html(""),$(t).removeClass("error"),!0))},_checkNick:function(e,t){return!$(e).is(":visible")||($.trim($(e).val()).length>=1&&$.trim($(e).val()).length<=12?($(e).parent().find("span").html(""),$(e).removeClass("error"),!0):($(e).parent().find("span").html(t),$(e).addClass("error").focus(),!1))},_validateForm:function(){var e=this;return!!e._checkRequired('input[name="account"]',"请输入您的手机号")&&(!!e._checkMobile('input[name="account"]',"手机号输入有误，请重新输入")&&(!!e._checkAgreement('input[name="agreement"]',"请阅读并勾选同意注册协议")&&(!!e._checkRequired('input[name="validate"]',"请输入验证码")&&(!!e._checkRequired('input[name="code"]',"请输入短信验证码")&&(!!e._checkRequired('input[name="pw"]',"请设置登录密码")&&(!!e._checkPassword('input[name="pw"]',"密码需为6-12位英文、数字、特殊符号仅支持_")&&(!!e._checkRequired('input[name="pw2"]',"请输入确认密码，需与上方密码相同")&&(!!e._checkPasswordRepeat('input[name="pw"]','input[name="pw2"]',"两次密码不一致，请重新输入")&&(!!e._checkRequired('input[name="nick"]',"请设置您在虾米音乐的昵称")&&!!e._checkNick('input[name="nick"]',"昵称需为1-12个汉字、英文、符号"))))))))))},_gotoStep:function(e){$("#body ol li").removeClass("current"),$('#body ol li[data-step="'+e+'"]').addClass("current"),$("#body [data-content]").hide(),$('#body [data-content="'+e+'"]').show(),$("#body .notice").removeClass("error").html("&nbsp;")},_gotoReferrer:function(){var e=this;e.referrer.indexOf("login.xiami.com")?location.href="http://www.xiami.com":location.href=e.referrer},_attatchEvent:function(){var e=this;$("#body form").on("submit",function(){return!1}),$("#body #open_agreement_window").on("click",function(){window.showDialog("",'<style>.dialog_main .popup_content{width:600px;height:400px;}.dialog_main .popup_content iframe{width:100%;height:100%;border:none;}</style><h3 class="jqmTitle">虾米音乐用户服务协议<a class="jqmClose" title="关闭" href="">关闭</a></h3><div class="popup_content"><iframe src="http://act.xiami.com/wow/xiami/act/protocol" frameborder="0"></iframe></div>')}),$("#body #go_step_2").on("click",function(){if(e._validateForm()){var t=$('select[name="countryCode"]').val(),a=$.trim($('input[name="account"]').val());e.validate=$.trim($('input[name="validate"]').val()),$.ajax({method:"get",url:"/passport/checkaccount",dataType:"json",data:{_xiamitoken:_xiamitoken,type:"register",countryCode:t,account:a,validate:e.validate}}).done(function(t){t.status?(e._gotoStep(2),$("#body #send_verify_code").click()):(t.verifycode&&($("#body #validatecode").show(),$("#body #validate").attr("disabled",!1),$("#body #validate_img").click()),$("#body .notice").addClass("error").html(t.msg))})}}),$("#body #send_verify_code").on("click",function(){var t=this;$(t).attr("disabled",!0);var a,n=60;clearInterval(a),a=setInterval(function(){n?$(t).html("重新发送（"+n--+"s）"):(clearInterval(a),$(t).html("发送验证码"),$(t).attr("disabled",!1))},1e3);var r=$('select[name="countryCode"]').val(),i=$.trim($('input[name="account"]').val());$.ajax({method:"get",url:"/passport/sendcheckcode",dataType:"json",data:{_xiamitoken:_xiamitoken,countryCode:r,account:i,validate:e.validate}}).done(function(e){e.status?$("#body .notice").removeClass("error").html("短信校验码已发送到<em>"+i+"</em>，请勿泄露"):$("#body .notice").addClass("error").html(e.msg)})}),$("#body #go_step_3").on("click",function(){if(e._validateForm()){var t=$('select[name="countryCode"]').val(),a=$.trim($('input[name="account"]').val()),n=$.trim($('input[name="code"]').val()),r=$('input[name="pw"]').val(),i=$('input[name="pw2"]').val(),o=$.trim($('input[name="nick"]').val());$.ajax({method:"get",url:"/passport/register",dataType:"json",data:{_xiamitoken:_xiamitoken,countryCode:t,account:a,code:n,pw:r,pw2:i,nick:o,validate:e.validate}}).done(function(t){if(t.status){e._gotoStep(3),$(".success span em").html(a);var n,r=10;clearInterval(n),n=setInterval(function(){r?$(".success b").html(r--+"秒后，跳转至之前页面"):(clearInterval(n),e._gotoReferrer())},1e3)}else $("#body .notice").addClass("error").html(t.msg)})}}),$("#body #go_back_direct").on("click",function(){e._gotoReferrer()})}};e.exports=a}]);